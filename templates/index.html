<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CivicTrack - Legislative Activity</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>CivicTrack - Legislative Activity</h1>

    <!-- START: Filter Controls -->
    <div id="filter-controls" style="margin-bottom: 15px;">
        <span style="font-weight: bold; margin-right: 10px;">Filter by Party:</span>
        <label><input type="radio" name="party-filter" value="ALL" checked> All</label>
        <label><input type="radio" name="party-filter" value="D"> Democrat</label>
        <label><input type="radio" name="party-filter" value="R"> Republican</label>
        <label><input type="radio" name="party-filter" value="ID"> Independent/Other</label>
    </div>
    <!-- END: Filter Controls -->

    <label for="member-select">Choose a Member:</label>
    <!-- Member Select Dropdown - Populated by JS -->
    <!-- Added fallback message directly within the select's container -->
    <div id="member-select-container">
        {% if all_members_json and all_members_json != '[]' %}
            <select name="members" id="member-select">
               <option value="">-- Select Party Filter --</option>
               <!-- Options will be populated by JS -->
            </select>
        {% else %}
            <p style="color: red; font-weight: bold; display: inline-block; margin-left: 10px;">Could not load member list. Check application logs.</p>
            <select name="members" id="member-select" disabled style="display: none;">
                 <option value="">-- Member List Unavailable --</option>
            </select>
        {% endif %}
    </div>


    <div id="member-info" style="margin-top: 20px;">
        <!-- Data sections -->
        <section id="member-details-section">
             <h2>Member Details</h2>
             <!-- ARIA Live region for announcements -->
             <div id="member-status" aria-live="polite">
                <!-- Using div for details to allow innerHTML -->
                <div id="member-details-content">Select a member to view details.</div>
             </div>
        </section>

        <hr> <!-- Visual separator -->

        <section id="committee-section">
            <h2>Committee Assignments</h2>
            <!-- ARIA Live region -->
            <div id="committee-status" aria-live="polite">
                <div class="loader"></div> <!-- Loader -->
                <ul id="committee-list">
                    <li>Select a member to view committees.</li>
                </ul>
             </div>
        </section>

        <hr> <!-- Visual separator -->

         <section id="sponsored-bills-section">
            <h2>Recently Sponsored Bills</h2>
             <!-- ARIA Live region -->
             <div id="sponsored-bills-status" aria-live="polite">
                <div class="loader"></div> <!-- Loader -->
                <ul id="sponsored-bills-list">
                    <li>Select a member to view sponsored bills.</li>
                </ul>
             </div>
        </section>

        <hr> <!-- Visual separator -->

        <section id="votes-section">
            <h2>Recent Votes</h2>
             <!-- ARIA Live region -->
             <div id="votes-status" aria-live="polite">
                <div class="loader"></div> <!-- Loader -->
                <ul id="vote-list">
                    <li>Select a member to view votes.</li>
                </ul>
             </div>
        </section>
    </div>

    <!-- Embed full member list as JSON for JavaScript -->
    <!-- Ensure this script tag is present and uses the |tojson filter -->
    <script>
        const allMembersData = JSON.parse({{ all_members_json|tojson }});
    </script>

    <!-- Link your main script AFTER the data is defined -->
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>